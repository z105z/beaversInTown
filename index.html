<!DOCTYPE html>

<html lang="en">

<head>
	
	<title>Document</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no, maximum-scale=1" />
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
	<script src="/socket.io/socket.io.js"></script>
	
	<style type="text/css">
		*{
			padding: 0;
			margin: 0;
		}
		#mainRegistrationMenu{
			width: 400px;
			height: 500px;
			background: #31F51D;
			margin-top: 100px;
			margin-left: calc(50% - 400px / 2);
		}
		#mainAuthorizationMenu{
			width: 400px;
			height: 300px;
			background: #EB1010;
			margin-top: 100px;
			margin-left: calc(50% - 400px / 2);
			display: none;
			
		}
		.registrationFields{
			width: 300px;
			height: 40px;
			margin-left: calc(50% - 300px / 2);
			margin-top: 20px;
		}
		#span_1{
			font-size: 25px;
			font-family: Arial;
			margin-left: calc(50% - 200px / 2);
		}
		#span_2{
			font-size: 25px;
			font-family: Arial;
			margin-left: calc(50% - 200px / 2);
		}
	</style>
</head>

<body>
	<div id="mainRegistrationMenu">
		<input type="text" name="field_1" id="field_1" placeholder="Введите никнейм..." class="registrationFields">
		<input type="text" name="field_2" id="field_2" placeholder="Введите логин..." class="registrationFields">
		<input type="password" name="field_3" id="field_3" placeholder="Введите пароль..." class="registrationFields">
		<input type="password" name="field_4" id="field_4" placeholder="Повторите пароль..." class="registrationFields">
		<input type="button" name="registrationButton1" id="registrationButton1" value="Зарегистрироваться" class="registrationFields">
		<input type="button" name="registrationButton2" id="registrationButton2" value="Авторизация" class="registrationFields">
		<span id="span_1"></span></div>

	<div id="mainAuthorizationMenu">
		<input type="text" name="field_5" id="field_5" placeholder="Введите логин..." class="registrationFields">
		<input type="password" name="field_6" id="field_6" placeholder="Введите пароль..." class="registrationFields">
		<input type="button" name="authorizationButton1" id="authorizationButton1" value="Войти" class="registrationFields">
		<input type="button" name="authorizationButton2" id="authorizationButton2" value="Регистрация" class="registrationFields">
		<span id="span_2"></span>
	</div>

	<script type="text/javascript">

		var socket = io();

		socket.on('redir', function(){
			document.location.href = "/main";
		});


		document.getElementById('registrationButton2').addEventListener('click', function(){
			document.getElementById('mainRegistrationMenu').style.display = "none";
			document.getElementById('mainAuthorizationMenu').style.display = "block";
			
		});
		document.getElementById('authorizationButton2').addEventListener('click', function(){
			document.getElementById('mainAuthorizationMenu').style.display = "none";
			document.getElementById('mainRegistrationMenu').style.display = "block";});

		document.getElementById('authorizationButton1').addEventListener('click', function(){
			var login = document.getElementById('field_5').value;
			var password = document.getElementById('field_6').value;

			function clearFields(mistakeNumber){
				var text = mistakeNumber==1 ? "Введите логин" : mistakeNumber==2 ? "Введите пароль" : "Отлично";
				var clear = function(id){document.getElementById(id).innerHTML = ''; document.getElementById(id).value = '';}
				for(var i = 5;i <= 6;i++){
					clear('field_' + i);
				}
				document.getElementById('span_2').innerHTML = text;

				setTimeout(function(){clear('span_2')}, 1000);}

			if(!login){
				clearFields(1);
			}
			else if(!password){
				clearFields(2);
			}
			else{
				$.get("/authorization?login=" + login + "&password=" + password, function(data, status){});
			}});
		document.getElementById('registrationButton1').addEventListener('click',function(){
			var nickname = document.getElementById('field_1').value;
			var login = document.getElementById('field_2').value;
			var password = document.getElementById('field_3').value;
			var rePassword = document.getElementById('field_4').value;

			function clearFields(mistakeNumber){
				var text = mistakeNumber==1 ? "Введите никнейм" : mistakeNumber==2 ? "Введите логин" : mistakeNumber==3 ? "Введите пароль" : mistakeNumber==4 ? "Пароли не совпадают" : "Отлично";
				var clear = function(id){document.getElementById(id).innerHTML = ''; document.getElementById(id).value = '';}
				for(var i = 1;i <= 4;i++){
					clear('field_' + i);
				}
				document.getElementById('span_1').innerHTML = text;

				setTimeout(function(){clear('span_1')}, 1000);}

			if(!nickname||nickname.length<5){
				clearFields(1);
			}
			else if(!login||login.length<5){
				clearFields(2);
			}
			else if(!password||password.length<6){
				clearFields(3);
			}
			else if(!rePassword || password!=rePassword){
				clearFields(4);
			}
			else{
				$.get("/registration?nickname=" + nickname + "&login=" + login + "&password=" + password, function(data, status){});
			}
		});

	</script>
</body>

</html>